<!-- failuredetector_modal.jinja2 (Definitive Reset Version) -->
<div id="failure_report_modal" class="modal hide fade" tabindex="-1" role="dialog">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
        <h3 data-bind="text: modalTitle">Report Print Outcome</h3>
    </div>
    <div class="modal-body">

        <!-- Screen 1: "Did this print fail?" -->
        <div data-bind="visible: modalScreen() === 'confirm_failure'">
            <h4>Did this print fail?</h4>
            <p>Please review the final frame of your print.</p>
            <img data-bind="attr: { src: snapshotUrlWithCacheBuster }" style="width: 100%; border-radius: 4px; margin-bottom: 15px; background-color: #222;" />
            <div class="text-center">
                <button class="btn btn-success btn-large" style="width: 45%;" data-bind="click: reportNo">No, it was a Success</button>
                <button class="btn btn-danger btn-large" style="width: 45%;" data-bind="click: reportYes">Yes, it Failed</button>
            </div>
        </div>

        <!-- All other screens are just placeholders for now -->
        <div data-bind="visible: modalScreen() === 'select_frame'">
            <h4>Step 2: Select Frame</h4>
            <div class="alert alert-info">This feature is under construction.</div>
        </div>
        <div data-bind="visible: modalScreen() === 'draw_boxes'">
            <h4>Step 3: Draw Boxes</h4>
            <div class="alert alert-info">This feature is under construction.</div>
        </div>
        <div data-bind="visible: modalScreen() === 'final_confirm'">
            <h4>Step 4: Confirm & Submit</h4>
            <div class="alert alert-info">This feature is under construction.</div>
        </div>

    </div>
    <div class="modal-footer" data-bind="visible: modalScreen() !== 'confirm_failure'">
        <button class="btn" data-bind="click: modalBack">Back</button>
        <button class="btn" data-dismiss="modal">Cancel</button>
        <button class="btn btn-primary" data-bind="click: modalConfirm, text: modalConfirmText"></button>
    </div>
</div>
